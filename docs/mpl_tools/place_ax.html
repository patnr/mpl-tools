<!-- Search file for "CHANGE" for my own changes -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>mpl_tools.place_ax API documentation</title>
<meta name="description" content="Tools for placing axes in a figure." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<link rel="preconnect" href="https://www.google.com">
<script async src="https://cse.google.com/cse.js?cx=017837193012385208679:pey8ky8gdqw"></script>
<style>
.gsc-control-cse {padding:0 !important;margin-top:1em}
body.gsc-overflow-hidden #sidebar {overflow: visible;}
</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
<a href="https://github.com/patricknraanes/mpl-tools" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>mpl_tools.place_ax</code></h1>
</header>
<section id="section-intro">
<p>Tools for placing axes in a figure.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/patricknraanes/mpl-tools/blob/master/mpl_tools/place_ax.py#L0-L153" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;Tools for placing axes in a figure.&#34;&#34;&#34;
import matplotlib as mpl
from matplotlib import pyplot as plt
from matplotlib.artist import allow_rasterization

# from mpl_tools.misc import *

__all__ = [&#34;align_ax_with&#34;, &#34;anchor_axes&#34;, &#34;set_ax_size&#34;, &#34;trans2fig&#34;]


def set_ax_size(ax, w, h):
    &#34;&#34;&#34;Width/Height in display (pixel) coords.&#34;&#34;&#34;
    fig = ax.figure
    w, h = fig.transFigure.inverted().transform([w, h])
    x, y, _, _ = ax.get_position().bounds
    ax.set_position([x, y, w, h])


def adjust_position(ax, adjust_extent=False, **kwargs):
    &#34;&#34;&#34;Adjust (add) to axes bounding box.

    Parameters
    ----------
    ax: matplotlib.axes
    adjust_extent: bool, optional
        If true: `x` and `y` produces `ax` resize, rather than shift.
        Defaults: False
    kwargs: dict
        the keys must be `x0`, `y0`, `width`, `height`;
        the values are length changes.
    &#34;&#34;&#34;
    # Load get_position into d
    pos = ax.get_position()
    pos = {key: getattr(pos, key) for key in [&#39;x0&#39;, &#39;y0&#39;, &#39;width&#39;, &#39;height&#39;]}

    abbrevs = dict(
        x = &#34;x0&#34;,
        y = &#34;y0&#34;,
        w = &#34;width&#34;,
        h = &#34;height&#34;,
    )

    # Make adjustments
    for key, value in kwargs.items():
        key = abbrevs.get(key, key)

        # Adjust
        pos[key] += value

        if adjust_extent:
            if key == &#39;x0&#39;:
                pos[&#39;width&#39;]  -= value
            if key == &#39;y0&#39;:
                pos[&#39;height&#39;] -= value

    # Set
    ax.set_position(pos.values())


def align_ax_with(ax, bbox, loc, pad=4):
    &#34;&#34;&#34;Set the location of ax relative to bbox.

    This is similar to legend placement, where bbox_to_anchor
    (here just bbox) defines the anchor position (as a box),
    and loc specifies the relative placement as the edge(s) to be aligned.

    However, here, loc should be one of NW, NE, SW, SE, E, W, N, S (as in Matlab),
    and each letter may appended by ``+`` (e.g. N+W+),
    meaning that the edge of ax is placed
    *outside* the opposite edge of (the container) bbox,
    with padding specified by pad.
    &#34;&#34;&#34;
    # Get new bbox placed with mpl builtin tool
    B = ax.bbox.anchored(loc.replace(&#34;+&#34;, &#34;&#34;), container=bbox)
    # Adjust for + flags
    x, y, w, h = B.bounds
    if &#34;W+&#34; in loc:
        x += pad + bbox.width
    if &#34;E+&#34; in loc:
        x -= pad + bbox.width
    if &#34;S+&#34; in loc:
        y -= pad + h
    if &#34;N+&#34; in loc:
        y += pad + h
    B = mpl.transforms.Bbox.from_bounds(x, y, w, h)
    # Convert to figure coordinates
    # B = B.inverse_transformed(ax.figure.transFigure) # deprecated
    B = B.transformed(ax.figure.transFigure.inverted())
    # Set
    ax.set_position(B)


# TODO: make use of this in the above funcs
def trans2fig(axis, rect, from_data=True):
    &#34;&#34;&#34;Transform (data or axis) coordinates to figure coordinates.

    Inspired by: https://stackoverflow.com/a/17478227/38281.

    Example
    -------
    &gt;&gt;&gt; rect = trans2fig(ax, [x,y,w,h]) # doctest: +SKIP
    ... ax2 = ax.figure.add_axes(rect)
    &#34;&#34;&#34;
    x, y, w, h = rect

    FT = axis.figure.transFigure.inverted().transform

    if from_data:
        # Transform: data--&gt;display--&gt;figure
        def T(xy):
            return FT(axis.transData.transform(xy))
    else:
        # Transform: axes--&gt;display--&gt;figure
        def T(xy):
            return FT(axis.transAxes.transform(xy))

    x, y = T((x, y))
    w, h = T([w, h]) - T([0, 0])  # affine transform wrt. 0

    return x, y, w, h


def anchor_axes(ax, get_anchor, loc=&#34;NW+&#34;):
    &#34;&#34;&#34;Attach axes to an anchoring bbox, and keep its size fixed.

    This is done by updating its placement whenever draw() is called,
    e.g. when the figure is resized.

    See also mpl_toolkits.axes_grid1.{Divider,Size}, demonstrated by:
    https://matplotlib.org/gallery/axes_grid1/demo_fixed_size_axes.html
    &#34;&#34;&#34;
    # Save size
    size = ax.bbox.width, ax.bbox.height

    # Patch the Axes instance&#39;s draw() method.
    @allow_rasterization
    def draw(self, renderer):
        set_ax_size(self, *size)
        align_ax_with(self, get_anchor(), loc)
        _draw(renderer)
    _draw = ax.draw
    ax.draw = draw.__get__(ax)


def get_legend_bbox(ax):
    &#34;&#34;&#34;Get legend&#39;s bbox in pixel (&#34;display&#34;) coords.&#34;&#34;&#34;
    # Must pause/draw before bbox can be known
    def inner():
        plt.draw()
        leg = ax.get_legend()
        bbox = leg.get_window_extent()
        # bbox = leg.get_frame().get_bbox()
        return bbox
    return inner</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="mpl_tools.place_ax.align_ax_with"><code class="name flex">
<span>def <span class="ident">align_ax_with</span></span>(<span>ax, bbox, loc, pad=4)</span>
</code></dt>
<dd>
<div class="desc"><p>Set the location of ax relative to bbox.</p>
<p>This is similar to legend placement, where bbox_to_anchor
(here just bbox) defines the anchor position (as a box),
and loc specifies the relative placement as the edge(s) to be aligned.</p>
<p>However, here, loc should be one of NW, NE, SW, SE, E, W, N, S (as in Matlab),
and each letter may appended by <code>+</code> (e.g. N+W+),
meaning that the edge of ax is placed
<em>outside</em> the opposite edge of (the container) bbox,
with padding specified by pad.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/patricknraanes/mpl-tools/blob/master/mpl_tools/place_ax.py#L60-L90" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def align_ax_with(ax, bbox, loc, pad=4):
    &#34;&#34;&#34;Set the location of ax relative to bbox.

    This is similar to legend placement, where bbox_to_anchor
    (here just bbox) defines the anchor position (as a box),
    and loc specifies the relative placement as the edge(s) to be aligned.

    However, here, loc should be one of NW, NE, SW, SE, E, W, N, S (as in Matlab),
    and each letter may appended by ``+`` (e.g. N+W+),
    meaning that the edge of ax is placed
    *outside* the opposite edge of (the container) bbox,
    with padding specified by pad.
    &#34;&#34;&#34;
    # Get new bbox placed with mpl builtin tool
    B = ax.bbox.anchored(loc.replace(&#34;+&#34;, &#34;&#34;), container=bbox)
    # Adjust for + flags
    x, y, w, h = B.bounds
    if &#34;W+&#34; in loc:
        x += pad + bbox.width
    if &#34;E+&#34; in loc:
        x -= pad + bbox.width
    if &#34;S+&#34; in loc:
        y -= pad + h
    if &#34;N+&#34; in loc:
        y += pad + h
    B = mpl.transforms.Bbox.from_bounds(x, y, w, h)
    # Convert to figure coordinates
    # B = B.inverse_transformed(ax.figure.transFigure) # deprecated
    B = B.transformed(ax.figure.transFigure.inverted())
    # Set
    ax.set_position(B)</code></pre>
</details>
</dd>
<dt id="mpl_tools.place_ax.anchor_axes"><code class="name flex">
<span>def <span class="ident">anchor_axes</span></span>(<span>ax, get_anchor, loc='NW+')</span>
</code></dt>
<dd>
<div class="desc"><p>Attach axes to an anchoring bbox, and keep its size fixed.</p>
<p>This is done by updating its placement whenever draw() is called,
e.g. when the figure is resized.</p>
<p>See also mpl_toolkits.axes_grid1.{Divider,Size}, demonstrated by:
<a href="https://matplotlib.org/gallery/axes_grid1/demo_fixed_size_axes.html">https://matplotlib.org/gallery/axes_grid1/demo_fixed_size_axes.html</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/patricknraanes/mpl-tools/blob/master/mpl_tools/place_ax.py#L123-L142" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def anchor_axes(ax, get_anchor, loc=&#34;NW+&#34;):
    &#34;&#34;&#34;Attach axes to an anchoring bbox, and keep its size fixed.

    This is done by updating its placement whenever draw() is called,
    e.g. when the figure is resized.

    See also mpl_toolkits.axes_grid1.{Divider,Size}, demonstrated by:
    https://matplotlib.org/gallery/axes_grid1/demo_fixed_size_axes.html
    &#34;&#34;&#34;
    # Save size
    size = ax.bbox.width, ax.bbox.height

    # Patch the Axes instance&#39;s draw() method.
    @allow_rasterization
    def draw(self, renderer):
        set_ax_size(self, *size)
        align_ax_with(self, get_anchor(), loc)
        _draw(renderer)
    _draw = ax.draw
    ax.draw = draw.__get__(ax)</code></pre>
</details>
</dd>
<dt id="mpl_tools.place_ax.set_ax_size"><code class="name flex">
<span>def <span class="ident">set_ax_size</span></span>(<span>ax, w, h)</span>
</code></dt>
<dd>
<div class="desc"><p>Width/Height in display (pixel) coords.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/patricknraanes/mpl-tools/blob/master/mpl_tools/place_ax.py#L11-L16" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def set_ax_size(ax, w, h):
    &#34;&#34;&#34;Width/Height in display (pixel) coords.&#34;&#34;&#34;
    fig = ax.figure
    w, h = fig.transFigure.inverted().transform([w, h])
    x, y, _, _ = ax.get_position().bounds
    ax.set_position([x, y, w, h])</code></pre>
</details>
</dd>
<dt id="mpl_tools.place_ax.trans2fig"><code class="name flex">
<span>def <span class="ident">trans2fig</span></span>(<span>axis, rect, from_data=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Transform (data or axis) coordinates to figure coordinates.</p>
<p>Inspired by: <a href="https://stackoverflow.com/a/17478227/38281.">https://stackoverflow.com/a/17478227/38281.</a></p>
<h2 id="example">Example</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; rect = trans2fig(ax, [x,y,w,h]) # doctest: +SKIP
... ax2 = ax.figure.add_axes(rect)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/patricknraanes/mpl-tools/blob/master/mpl_tools/place_ax.py#L94-L120" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def trans2fig(axis, rect, from_data=True):
    &#34;&#34;&#34;Transform (data or axis) coordinates to figure coordinates.

    Inspired by: https://stackoverflow.com/a/17478227/38281.

    Example
    -------
    &gt;&gt;&gt; rect = trans2fig(ax, [x,y,w,h]) # doctest: +SKIP
    ... ax2 = ax.figure.add_axes(rect)
    &#34;&#34;&#34;
    x, y, w, h = rect

    FT = axis.figure.transFigure.inverted().transform

    if from_data:
        # Transform: data--&gt;display--&gt;figure
        def T(xy):
            return FT(axis.transData.transform(xy))
    else:
        # Transform: axes--&gt;display--&gt;figure
        def T(xy):
            return FT(axis.transAxes.transform(xy))

    x, y = T((x, y))
    w, h = T([w, h]) - T([0, 0])  # affine transform wrt. 0

    return x, y, w, h</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="gcse-search" style="height: 70px"
data-as_oq="inurl:github.com/patricknraanes/mpl-tools site:mpl-tools.github.io"
data-gaCategoryParameter="mpl_tools.place_ax">
</div>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="mpl_tools" href="index.html">mpl_tools</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="mpl_tools.place_ax.align_ax_with" href="#mpl_tools.place_ax.align_ax_with">align_ax_with</a></code></li>
<li><code><a title="mpl_tools.place_ax.anchor_axes" href="#mpl_tools.place_ax.anchor_axes">anchor_axes</a></code></li>
<li><code><a title="mpl_tools.place_ax.set_ax_size" href="#mpl_tools.place_ax.set_ax_size">set_ax_size</a></code></li>
<li><code><a title="mpl_tools.place_ax.trans2fig" href="#mpl_tools.place_ax.trans2fig">trans2fig</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>