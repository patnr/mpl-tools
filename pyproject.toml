[tool.poetry]
name = "mpl-tools"
version = "0.2"
description = "Tools for working with matplotlib"
authors = ["patricknraanes <patrick.n.raanes@gmail.com>"]
license = "MIT"
readme = "README.md"
keywords = ["matplotlib", "plotting"]
repository = "https://github.com/patricknraanes/mpl-tools"
#homepage = "https://python-poetry.org/"
#documentation = "https://python-poetry.org/docs"

[tool.poetry.dependencies]
python = "^3.7"
matplotlib = ">=3.0"
importlib-metadata = {version = "^1.0", python = "<3.8"} # for <3.8 only

[tool.poetry.dev-dependencies]
flakehell = "*"
flake8-docstrings = "*"
flake8-bugbear = "*"
flake8-comprehensions = "*"
flake8-isort = "*"
flake8-builtins = "*"
pep8-naming = "*"

line_profiler = "*"
pre-commit = "*"
ipdb = "*"
pdbpp = "*"
pudb = "*"
ipython = "*"
pyqt5 = "*" # GUI-backend for mpl
jedi = "<0.18" # ipython/issues/12740
tox = "^3.20.1"
pytest-cov = "^2.10.1"
pytest-sugar = "^0.9.4"
pytest = ">=6" # >6 to enable config in pyproject.toml
tox-poetry-installer = {extras = ["poetry"], version = "^0.6.1"}
# pytest-benchmark pytest-clarity pytest-xdist

[tool.tox]
legacy_tox_ini = """
# Poetry/tox integration is subject to rapid change, I suspect. Read these:
# - https://tox.readthedocs.io/en/latest/example/package.html#poetry
# - https://tox.readthedocs.io/en/latest/example/basic.html#pyproject-toml-tox-legacy-ini
# - https://python-poetry.org/docs/faq/#is-tox-supported
# - https://github.com/python-poetry/poetry/issues/1941
# - https://github.com/python-poetry/poetry/issues/1745

[tox]
# - List of tests (detailed under [testenv:name] below) to run.
# - Requires that the python versions exist on your system.
#   - On ubuntu, apt install was sufficient to get them.
#   - On MacOS, use pyenv coz brew does not make muliple versions available concurrently.
envlist = py3{7,8,9}
# Required with poetry:
isolated_build = True

[tox:.package]
# I don't quite understand what this does.
basepython = python3

# Top-level test specificatios (gets inherited by other testenvs).
# Combines with `envlist` to generate tests.
[testenv]
# Only run test on this platform
platform = linux|darwindeps

# Use tox-poetry-installer to install from lockfile (for reproducibility),
# including the dev-dependencies (to avoid repeating ourselves):
install_dev_deps = true

# Use `{posargs}` to forward arguments from tox command
commands =
    pytest
"""

[tool.pytest.ini_options]
minversion = "6.0"
addopts = "--cov=mpl_tools"
testpaths = [
    "tests",
    #"integration",
]

[tool.autopep8]
max_line_length = 120
ignore = "E501,W6"  # or ["E501", "W6"]

# Unlike flake8, flakehell
# - may be configured in pyproject.toml
# - has prettier formatting
# - does not use installed plugins that are not listed below
[tool.flakehell]
# optionally inherit from remote config (or local if you want)
# base = "https://raw.githubusercontent.com/life4/flakehell/master/pyproject.toml"
exclude = ["README.rst", "README.md", "example.py"]
max_line_length = 88
format = "grouped" # also try "stat"
show_source = false
#whitelist = "../../allowlist.txt" # Used by flake8-spellcheck.

[tool.flakehell.plugins]
pyflakes = ["+*"]
pycodestyle = ["+*"]
#mccabe = ["+*"]
#pylint = ["+*"]
pep8-naming = ["+*",
    # ignore lowercase demands:
    "-N802", "-N803", "-N806"]
#flake8-bandit = ["-*"]
flake8-bugbear = ["+*"]
flake8-builtins = ["+*"]
flake8-comprehensions = ["+*", "-C408"]
#flake8-darglint = ["+*"]
#flake8-docstrings = ["+*"]
#flake8-eradicate = ["+*"]
#flake8-isort = ["+*"]
#flake8-pytest-style = ["+*"]
#flake8-spellcheck = ["+*"]

# Example configs. NB: remember to comment-out the corresponding lines above
#pyflakes = ["+*", "-F401"] # ignore F401
#pycodestyle = ["+*", "-E722"] # ignore E722
#flake8-docstrings = ["-*"] # explicitly disable plugin
#flake8-bandit = ["+*", "-S322"]
#flake8-bandit = ["-*", "+S1??"] # enable only codes from S100 to S199

# Exceptions:
# [tool.flakehell.exceptions."tests/"]
# pycodestyle = ["-F401"]     # disable a check
# pyflakes = ["-*"]           # disable a plugin
# [tool.flakehell.exceptions."tests/test_example.py"]
# pyflakes = ["+*"]           # enable a plugin

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"
